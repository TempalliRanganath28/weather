<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andhra pradesh live weather</title>
</head>
<style>
        body {
            font-family: Arial;
            background: #f0f4f8;
            padding: 20px;
        }
        h2 {
            text-align: center;
            color: #0077cc;
        }
        #time {
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background: #0077cc;
            color: white;
        }
        tr:nth-child(even) {
            background: #e6f0fa;
        }
        #refreshBtn {
            display: block;
            margin: 15px auto;
            padding: 10px 20px;
            background: #0077cc;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }
        #refreshBtn:hover {
            background: #005fa3;
        }
    </style>


<body>

<h2>Andhra Pradesh Live Weather</h2>
<p id="time"></p>

<button id="refreshBtn">Refresh</button>

<table>
    <tr>
        <th>District</th>
        <th>Temp (Â°C)</th>
        <th>Min</th>
        <th>Max</th>
        <th>Rain %</th>
    </tr>
    <tbody id="weather"></tbody>
</table>

<script>
const districts = {
    "Anakapalli": [17.6913, 83.0039],
    "Anantapur": [14.6819, 77.6006],
    "Annamayya": [13.8000, 79.0000],
    "Bapatla": [15.9040, 80.4675],
    "Chittoor": [13.2172, 79.1003],
    "Dr. B.R. Ambedkar Konaseema": [16.5833, 82.0167],
    "East Godavari": [16.9634, 82.2351],
    "Eluru": [16.7107, 81.0952],
    "Guntur": [16.3067, 80.4365],
    "Kakinada": [16.9891, 82.2475],
    "Krishna": [16.5151, 80.6326],
    "Kurnool": [15.8281, 78.0373],
    "Nandyal": [15.4770, 78.4836],
    "NTR": [16.5062, 80.6480],
    "Palnadu": [16.1500, 80.2000],
    "Parvathipuram Manyam": [18.7833, 83.4333],
    "Prakasam": [15.5000, 79.5000],
    "Sri Potti Sriramulu Nellore": [14.4426, 79.9865],
    "Sri Sathya Sai": [14.1651, 77.8110],
    "Srikakulam": [18.2949, 83.8938],
    "Tirupati": [13.6288, 79.4192],
    "Visakhapatnam": [17.6868, 83.2185],
    "Vizianagaram": [18.1067, 83.3956],
    "West Godavari": [16.7107, 81.0952],
    "YSR Kadapa": [14.4674, 78.8241]
};

async function loadWeather() {
    const tbody = document.getElementById("weather");
    tbody.innerHTML = "Loading data...";

    for (const district in districts) {
        const [lat, lon] = districts[district];
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&daily=temperature_2m_min,temperature_2m_max,precipitation_probability_max&timezone=Asia/Kolkata`;

        try {
            const res = await fetch(url);
            const data = await res.json();

            tbody.innerHTML += `
                <tr>
                    <td>${district}</td>
                    <td>${data.current_weather.temperature}</td>
                    <td>${data.daily.temperature_2m_min[0]}</td>
                    <td>${data.daily.temperature_2m_max[0]}</td>
                    <td>${data.daily.precipitation_probability_max[0]}</td>
                </tr>
            `;
        } catch (err) {
            tbody.innerHTML += `
                <tr>
                    <td>${district}</td>
                    <td colspan="4">Error fetching data</td>
                </tr>
            `;
        }
    }

    document.getElementById("time").innerText =
        "Last Updated: " + new Date().toLocaleString("en-IN", { timeZone: "Asia/Kolkata" });
}

// Load initially
loadWeather();

// Refresh on button click
document.getElementById("refreshBtn").addEventListener("click", loadWeather);
</script>

</body>
</html>
